# local.rules
# Custom Suricata rules for Network Security Project

# 1. Generic suspicious EXE download over HTTP
alert http any any -> any any (
    msg:"LOCAL Suspicious EXE download over HTTP";
    flow:to_client,established;
    file_data;
    content:".exe";
    nocase;
    http.response_body;
    classtype:suspicious-filename-detect;
    sid:9000001;
    rev:1;
)

# 2. Detect HTTP request to DMZ malicious path
alert http any any -> 10.10.20.10 8080 (
    msg:"LOCAL Download from DMZ malware host";
    flow:to_server,established;
    http.uri;
    content:"invoice_update.exe";
    nocase;
    classtype:trojan-activity;
    sid:9000002;
    rev:1;
)

# 3. Detect potential C2 traffic on TCP port 4444
alert tcp any any -> any 4444 (
    msg:"LOCAL Possible C2 traffic on TCP 4444";
    flow:to_server,established;
    classtype:command-and-control;
    sid:9000003;
    rev:1;
)
